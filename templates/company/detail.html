{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load staticfiles %}
{% load pinax_likes_tags %}

<title>{% block title %}  {{ company.name }}  | {{ block.super }} {% endblock %}</title>
{% block lead %}
 {{ company.name }} 
 {% endblock %}
{% block jumbotron %}
      <li class="breadcrumb-item"><a href='{% url "company:list" %}'>Company List</a></li>
      <li class="breadcrumb-item active">{{ company.name }}</li>
{% endblock  %}

{% block content %}

<div class="container">
  <div class=" col-md-9 mx-auto mb-4">
    <div class="carousel slide" data-ride="carousel" id="carouselExampleControls">
      <div class="carousel-inner">
        {% if company.photos %}
        {% for obj in company.photos.all %}
        <div class="carousel-item active">
          <img alt="..." class="d-block w-100" src='{{ obj.img.url }}'>
        </div>
        {% endfor %}
        {% else %}
        <div class="carousel-item">
          <img alt="..." class="d-block w-100" src='{% static "img/adult-african-descent-american-1234099.jpg" %}'>
        </div>
        <div class="carousel-item">
          <img alt="..." class="d-block w-100" src='{% static "img/cellphone-chairs-employees-1181401.jpg" %}'>
        </div>
        {% endif %}
      </div>
      <a class="carousel-control-prev" data-slide="prev" href="#carouselExampleControls" role="button">
        <span aria-hidden="true" class="carousel-control-prev-icon"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" data-slide="next" href="#carouselExampleControls" role="button">
        <span aria-hidden="true" class="carousel-control-next-icon"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
  </div>
  <!--simple card-->
  <div class="card mx-auto col-md-9 mb-2 ">
    <div class="card-body">
      <div class="row">
        {% if company.logo %}
        <div class="col-md-2 col-sm-6">
          <img alt="..." class="d-block w-100" src='{{ company.logo.url }}'>
        </div>
        {% else %}
        <div class="col-md-2 col-sm-12">
          <img alt="..." class="d-block w-100" src='{% static "img/avatar.svg" %}'>
        </div>
        {% endif %}
        <div class="pull-right col-md-10 col-sm-12">
          <div class="col-md-12 post-header-line">
            <h4 class="card-title text-primary">{{ company.name }}</h4>
            <h6 class="card-subtitle mb-2 text-muted">{{ company.country }}, {{ company.location }}
              | {{ company.openTime }} - {{ company.closetime }}</h6>
            <hr/>
            <span class="text-muted"><i
                    class="fas fa-star"></i> {{ company.average_rating | floatformat }} rating</span> |
            <span class="text-muted"><i class="fas fa-comments"></i> {{ company.review_set.count }} reviews</span>
            <hr/>
            <div>
              <h2 class="title-2">Property Description</h2>
              <p class="content-markdown card-text">{{ company.description }}</p>
            </div>
          </div>
        </div>
      </div>
      <div>
        <hr/>
        <a class="btn btn-primary" href='{% url "company:edit" company.slug %}'>Update </a>
        <a class="btn btn-danger" href='{% url "company:delete" company.slug %}'>Delete </a>
        <a class="btn btn-success" href='{% url "company:new_job" company.slug %}'>Add Job Vacancy </a>

      </div>
    </div>
  </div>

  <!--form-->
  <div class="card mx-auto col-md-9 mb-2">
    <div class="card-body">
      <h3>Add your review</h3>
      {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
      <form action="{% url 'reviews:new' company.id %}" class="form-ad" enctype="multipart/form-data"
            method="post">
        <div class="form-group is-empty">
          {% csrf_token %}
          {% crispy form %}
        </div>
      </form>
    </div>
  </div>
  <!--endform-->

  <!--simple other card 5-->
  <div class="card mx-auto col-md-9 mb-2 ">
    <div class="card-body">
      {% if company.review_set.all %}
      <h2 class="title-2">Recent reviews</h2>
      {% for review in company.review_set.all %}
      <div class="row">
        <div class="col-md-5 col-sm-12">
          <div class="row">
            <div class="col-md-5">
              <img alt="..." class="d-block w-100" src='{% static "img/avatar.svg" %}'>
            </div>
            <div class="col-md-7">
              <a href="{% url 'reviews:user_review_list' review.user.username %}">
                <h3 class="card-title">{{ review.user.username }}</h3></a>
              <h6 class="card-subtitle mb-2 text-muted">Follows by 13 People</h6>
              <h6 class="card-subtitle mb-2 text-muted">25 Reviews</h6>
              {% likes_widget request.user review %}
            </div>
          </div>
        </div>
        <div class="col-md-7 post-header-line">
          <h4 class="text-muted">Rated {{ review.rating }} of 5
            <small> | {{ review.pub_date|timesince }} ago</small>
          </h4>
          <hr/>
          <p>{{ review.comment }}</p>
          <div class="row">
            {% for photo in review.photos.all %}
            <div class="col-md-6 mb-2">
              <img class="d-block w-100" src="{{ photo.img.url }}" alt="{{ photo.alt }}">
            </div>
            {% endfor %}
          </div>
          <br/>
        </div>
      </div>
      <hr/>
      {% endfor %}
      {% else %}
      <p>No reviews for this company yet</p>
      {% endif %}
    </div>
  </div>
  <!--end of simple other card 5-->

</div>
{% endblock %}